/*

  Data on scintillator spectral absorption efficiency

  Currently using a 1 mm thick LYSO crystal
  Data from  "Efficiency Calculations for Selected Scintillators", Saint Gobin (2018)

  2024, Kian Shaker

*/

#ifndef SCINTILLATOR_H
#define SCINTILLATOR_H


// Scintillator area - important for scaling with the dose coefficients in 'DoseConversion.h'
const float SCINTILLATOR_AREA = 0.25;     // [cm^2]

// Define a struct to hold energy and absorption efficiency
struct ScintillatorData {
  uint16_t energy;       // Energy in keV
  float efficiency;      // Absorption efficiency
};

// Data for 1 mm thick LYSO
// Range: 10 keV - 1 MeV (probably overkill)
// Step size: 1 keV (probably granular enough considering the spectral resolution of the scint + SiPM assembly)
const ScintillatorData scintData[991] = {
  {10, 1},
  {11, 1},
  {12, 1},
  {13, 1},
  {14, 1},
  {15, 1},
  {16, 1},
  {17, 1},
  {18, 1},
  {19, 1},
  {20, 1},
  {21, 1},
  {22, 1},
  {23, 1},
  {24, 1},
  {25, 1},
  {26, 1},
  {27, 1},
  {28, 1},
  {29, 1},
  {30, 1},
  {31, 1},
  {32, 1},
  {33, 1},
  {34, 0.999},
  {35, 0.999},
  {36, 0.999},
  {37, 0.997},
  {38, 0.996},
  {39, 0.995},
  {40, 0.993},
  {41, 0.991},
  {42, 0.989},
  {43, 0.986},
  {44, 0.981},
  {45, 0.977},
  {46, 0.972},
  {47, 0.965},
  {48, 0.958},
  {49, 0.951},
  {50, 0.944},
  {51, 0.935},
  {52, 0.925},
  {53, 0.916},
  {54, 0.905},
  {55, 0.895},
  {56, 0.884},
  {57, 0.872},
  {58, 0.86},
  {59, 0.848},
  {60, 0.836},
  {61, 0.823},
  {62, 0.814},
  {63, 0.81},
  {64, 0.845},
  {65, 0.927},
  {66, 0.997},
  {67, 0.997},
  {68, 0.996},
  {69, 0.995},
  {70, 0.994},
  {71, 0.993},
  {72, 0.991},
  {73, 0.99},
  {74, 0.988},
  {75, 0.987},
  {76, 0.984},
  {77, 0.982},
  {78, 0.98},
  {79, 0.978},
  {80, 0.975},
  {81, 0.972},
  {82, 0.968},
  {83, 0.965},
  {84, 0.961},
  {85, 0.957},
  {86, 0.953},
  {87, 0.949},
  {88, 0.944},
  {89, 0.94},
  {90, 0.935},
  {91, 0.93},
  {92, 0.924},
  {93, 0.919},
  {94, 0.914},
  {95, 0.908},
  {96, 0.902},
  {97, 0.896},
  {98, 0.889},
  {99, 0.883},
  {100, 0.876},
  {101, 0.869},
  {102, 0.862},
  {103, 0.855},
  {104, 0.848},
  {105, 0.841},
  {106, 0.835},
  {107, 0.828},
  {108, 0.821},
  {109, 0.815},
  {110, 0.808},
  {111, 0.8},
  {112, 0.793},
  {113, 0.785},
  {114, 0.778},
  {115, 0.771},
  {116, 0.763},
  {117, 0.756},
  {118, 0.749},
  {119, 0.742},
  {120, 0.734},
  {121, 0.727},
  {122, 0.72},
  {123, 0.712},
  {124, 0.704},
  {125, 0.697},
  {126, 0.689},
  {127, 0.682},
  {128, 0.676},
  {129, 0.669},
  {130, 0.661},
  {131, 0.654},
  {132, 0.647},
  {133, 0.64},
  {134, 0.634},
  {135, 0.627},
  {136, 0.62},
  {137, 0.613},
  {138, 0.607},
  {139, 0.6},
  {140, 0.594},
  {141, 0.588},
  {142, 0.582},
  {143, 0.575},
  {144, 0.569},
  {145, 0.563},
  {146, 0.557},
  {147, 0.551},
  {148, 0.545},
  {149, 0.539},
  {150, 0.533},
  {151, 0.528},
  {152, 0.522},
  {153, 0.517},
  {154, 0.512},
  {155, 0.507},
  {156, 0.502},
  {157, 0.497},
  {158, 0.492},
  {159, 0.487},
  {160, 0.482},
  {161, 0.477},
  {162, 0.472},
  {163, 0.467},
  {164, 0.463},
  {165, 0.458},
  {166, 0.453},
  {167, 0.448},
  {168, 0.444},
  {169, 0.439},
  {170, 0.434},
  {171, 0.43},
  {172, 0.425},
  {173, 0.421},
  {174, 0.416},
  {175, 0.412},
  {176, 0.408},
  {177, 0.404},
  {178, 0.4},
  {179, 0.396},
  {180, 0.393},
  {181, 0.389},
  {182, 0.385},
  {183, 0.382},
  {184, 0.378},
  {185, 0.374},
  {186, 0.371},
  {187, 0.367},
  {188, 0.364},
  {189, 0.36},
  {190, 0.356},
  {191, 0.353},
  {192, 0.349},
  {193, 0.346},
  {194, 0.343},
  {195, 0.339},
  {196, 0.336},
  {197, 0.332},
  {198, 0.329},
  {199, 0.326},
  {200, 0.323},
  {201, 0.32},
  {202, 0.318},
  {203, 0.315},
  {204, 0.313},
  {205, 0.311},
  {206, 0.309},
  {207, 0.306},
  {208, 0.304},
  {209, 0.302},
  {210, 0.3},
  {211, 0.298},
  {212, 0.295},
  {213, 0.293},
  {214, 0.291},
  {215, 0.289},
  {216, 0.287},
  {217, 0.285},
  {218, 0.282},
  {219, 0.28},
  {220, 0.278},
  {221, 0.276},
  {222, 0.274},
  {223, 0.272},
  {224, 0.27},
  {225, 0.268},
  {226, 0.266},
  {227, 0.264},
  {228, 0.262},
  {229, 0.26},
  {230, 0.258},
  {231, 0.256},
  {232, 0.254},
  {233, 0.252},
  {234, 0.25},
  {235, 0.248},
  {236, 0.246},
  {237, 0.244},
  {238, 0.242},
  {239, 0.24},
  {240, 0.238},
  {241, 0.236},
  {242, 0.234},
  {243, 0.232},
  {244, 0.23},
  {245, 0.229},
  {246, 0.227},
  {247, 0.225},
  {248, 0.223},
  {249, 0.222},
  {250, 0.22},
  {251, 0.218},
  {252, 0.217},
  {253, 0.215},
  {254, 0.214},
  {255, 0.213},
  {256, 0.211},
  {257, 0.21},
  {258, 0.209},
  {259, 0.208},
  {260, 0.206},
  {261, 0.205},
  {262, 0.204},
  {263, 0.203},
  {264, 0.201},
  {265, 0.2},
  {266, 0.199},
  {267, 0.198},
  {268, 0.196},
  {269, 0.195},
  {270, 0.194},
  {271, 0.193},
  {272, 0.191},
  {273, 0.19},
  {274, 0.189},
  {275, 0.188},
  {276, 0.187},
  {277, 0.185},
  {278, 0.184},
  {279, 0.183},
  {280, 0.182},
  {281, 0.181},
  {282, 0.179},
  {283, 0.178},
  {284, 0.177},
  {285, 0.176},
  {286, 0.175},
  {287, 0.174},
  {288, 0.172},
  {289, 0.171},
  {290, 0.17},
  {291, 0.169},
  {292, 0.168},
  {293, 0.167},
  {294, 0.166},
  {295, 0.164},
  {296, 0.163},
  {297, 0.162},
  {298, 0.162},
  {299, 0.161},
  {300, 0.16},
  {301, 0.159},
  {302, 0.158},
  {303, 0.157},
  {304, 0.156},
  {305, 0.156},
  {306, 0.155},
  {307, 0.154},
  {308, 0.153},
  {309, 0.153},
  {310, 0.152},
  {311, 0.151},
  {312, 0.151},
  {313, 0.15},
  {314, 0.149},
  {315, 0.149},
  {316, 0.148},
  {317, 0.147},
  {318, 0.147},
  {319, 0.146},
  {320, 0.145},
  {321, 0.145},
  {322, 0.144},
  {323, 0.144},
  {324, 0.143},
  {325, 0.142},
  {326, 0.142},
  {327, 0.141},
  {328, 0.14},
  {329, 0.14},
  {330, 0.139},
  {331, 0.138},
  {332, 0.138},
  {333, 0.137},
  {334, 0.137},
  {335, 0.136},
  {336, 0.135},
  {337, 0.135},
  {338, 0.134},
  {339, 0.133},
  {340, 0.133},
  {341, 0.132},
  {342, 0.132},
  {343, 0.131},
  {344, 0.13},
  {345, 0.13},
  {346, 0.129},
  {347, 0.129},
  {348, 0.128},
  {349, 0.128},
  {350, 0.127},
  {351, 0.126},
  {352, 0.126},
  {353, 0.125},
  {354, 0.125},
  {355, 0.124},
  {356, 0.124},
  {357, 0.124},
  {358, 0.123},
  {359, 0.123},
  {360, 0.122},
  {361, 0.122},
  {362, 0.121},
  {363, 0.121},
  {364, 0.12},
  {365, 0.12},
  {366, 0.119},
  {367, 0.119},
  {368, 0.118},
  {369, 0.118},
  {370, 0.118},
  {371, 0.117},
  {372, 0.117},
  {373, 0.116},
  {374, 0.116},
  {375, 0.115},
  {376, 0.115},
  {377, 0.114},
  {378, 0.114},
  {379, 0.113},
  {380, 0.113},
  {381, 0.113},
  {382, 0.112},
  {383, 0.112},
  {384, 0.111},
  {385, 0.111},
  {386, 0.11},
  {387, 0.11},
  {388, 0.11},
  {389, 0.109},
  {390, 0.109},
  {391, 0.108},
  {392, 0.108},
  {393, 0.107},
  {394, 0.107},
  {395, 0.107},
  {396, 0.106},
  {397, 0.106},
  {398, 0.105},
  {399, 0.105},
  {400, 0.105},
  {401, 0.104},
  {402, 0.104},
  {403, 0.104},
  {404, 0.103},
  {405, 0.103},
  {406, 0.103},
  {407, 0.103},
  {408, 0.102},
  {409, 0.102},
  {410, 0.102},
  {411, 0.101},
  {412, 0.101},
  {413, 0.101},
  {414, 0.1},
  {415, 0.1},
  {416, 0.1},
  {417, 0.1},
  {418, 0.099},
  {419, 0.099},
  {420, 0.099},
  {421, 0.099},
  {422, 0.098},
  {423, 0.098},
  {424, 0.098},
  {425, 0.097},
  {426, 0.097},
  {427, 0.097},
  {428, 0.097},
  {429, 0.096},
  {430, 0.096},
  {431, 0.096},
  {432, 0.095},
  {433, 0.095},
  {434, 0.095},
  {435, 0.095},
  {436, 0.094},
  {437, 0.094},
  {438, 0.094},
  {439, 0.094},
  {440, 0.093},
  {441, 0.093},
  {442, 0.093},
  {443, 0.093},
  {444, 0.092},
  {445, 0.092},
  {446, 0.092},
  {447, 0.092},
  {448, 0.091},
  {449, 0.091},
  {450, 0.091},
  {451, 0.091},
  {452, 0.09},
  {453, 0.09},
  {454, 0.09},
  {455, 0.09},
  {456, 0.089},
  {457, 0.089},
  {458, 0.089},
  {459, 0.089},
  {460, 0.088},
  {461, 0.088},
  {462, 0.088},
  {463, 0.088},
  {464, 0.088},
  {465, 0.087},
  {466, 0.087},
  {467, 0.087},
  {468, 0.087},
  {469, 0.086},
  {470, 0.086},
  {471, 0.086},
  {472, 0.086},
  {473, 0.086},
  {474, 0.085},
  {475, 0.085},
  {476, 0.085},
  {477, 0.085},
  {478, 0.084},
  {479, 0.084},
  {480, 0.084},
  {481, 0.084},
  {482, 0.084},
  {483, 0.083},
  {484, 0.083},
  {485, 0.083},
  {486, 0.083},
  {487, 0.083},
  {488, 0.082},
  {489, 0.082},
  {490, 0.082},
  {491, 0.082},
  {492, 0.081},
  {493, 0.081},
  {494, 0.081},
  {495, 0.081},
  {496, 0.081},
  {497, 0.081},
  {498, 0.08},
  {499, 0.08},
  {500, 0.08},
  {501, 0.08},
  {502, 0.08},
  {503, 0.08},
  {504, 0.079},
  {505, 0.079},
  {506, 0.079},
  {507, 0.079},
  {508, 0.079},
  {509, 0.078},
  {510, 0.078},
  {511, 0.078},
  {512, 0.078},
  {513, 0.078},
  {514, 0.078},
  {515, 0.078},
  {516, 0.077},
  {517, 0.077},
  {518, 0.077},
  {519, 0.077},
  {520, 0.077},
  {521, 0.077},
  {522, 0.077},
  {523, 0.076},
  {524, 0.076},
  {525, 0.076},
  {526, 0.076},
  {527, 0.076},
  {528, 0.076},
  {529, 0.076},
  {530, 0.075},
  {531, 0.075},
  {532, 0.075},
  {533, 0.075},
  {534, 0.075},
  {535, 0.075},
  {536, 0.075},
  {537, 0.074},
  {538, 0.074},
  {539, 0.074},
  {540, 0.074},
  {541, 0.074},
  {542, 0.074},
  {543, 0.074},
  {544, 0.073},
  {545, 0.073},
  {546, 0.073},
  {547, 0.073},
  {548, 0.073},
  {549, 0.073},
  {550, 0.073},
  {551, 0.073},
  {552, 0.072},
  {553, 0.072},
  {554, 0.072},
  {555, 0.072},
  {556, 0.072},
  {557, 0.072},
  {558, 0.072},
  {559, 0.072},
  {560, 0.071},
  {561, 0.071},
  {562, 0.071},
  {563, 0.071},
  {564, 0.071},
  {565, 0.071},
  {566, 0.071},
  {567, 0.071},
  {568, 0.07},
  {569, 0.07},
  {570, 0.07},
  {571, 0.07},
  {572, 0.07},
  {573, 0.07},
  {574, 0.07},
  {575, 0.07},
  {576, 0.069},
  {577, 0.069},
  {578, 0.069},
  {579, 0.069},
  {580, 0.069},
  {581, 0.069},
  {582, 0.069},
  {583, 0.069},
  {584, 0.068},
  {585, 0.068},
  {586, 0.068},
  {587, 0.068},
  {588, 0.068},
  {589, 0.068},
  {590, 0.068},
  {591, 0.068},
  {592, 0.068},
  {593, 0.067},
  {594, 0.067},
  {595, 0.067},
  {596, 0.067},
  {597, 0.067},
  {598, 0.067},
  {599, 0.067},
  {600, 0.067},
  {601, 0.067},
  {602, 0.066},
  {603, 0.066},
  {604, 0.066},
  {605, 0.066},
  {606, 0.066},
  {607, 0.066},
  {608, 0.066},
  {609, 0.066},
  {610, 0.066},
  {611, 0.066},
  {612, 0.065},
  {613, 0.065},
  {614, 0.065},
  {615, 0.065},
  {616, 0.065},
  {617, 0.065},
  {618, 0.065},
  {619, 0.065},
  {620, 0.065},
  {621, 0.065},
  {622, 0.064},
  {623, 0.064},
  {624, 0.064},
  {625, 0.064},
  {626, 0.064},
  {627, 0.064},
  {628, 0.064},
  {629, 0.064},
  {630, 0.064},
  {631, 0.064},
  {632, 0.063},
  {633, 0.063},
  {634, 0.063},
  {635, 0.063},
  {636, 0.063},
  {637, 0.063},
  {638, 0.063},
  {639, 0.063},
  {640, 0.063},
  {641, 0.063},
  {642, 0.063},
  {643, 0.063},
  {644, 0.062},
  {645, 0.062},
  {646, 0.062},
  {647, 0.062},
  {648, 0.062},
  {649, 0.062},
  {650, 0.062},
  {651, 0.062},
  {652, 0.062},
  {653, 0.062},
  {654, 0.062},
  {655, 0.062},
  {656, 0.061},
  {657, 0.061},
  {658, 0.061},
  {659, 0.061},
  {660, 0.061},
  {661, 0.061},
  {662, 0.061},
  {663, 0.061},
  {664, 0.061},
  {665, 0.061},
  {666, 0.061},
  {667, 0.061},
  {668, 0.06},
  {669, 0.06},
  {670, 0.06},
  {671, 0.06},
  {672, 0.06},
  {673, 0.06},
  {674, 0.06},
  {675, 0.06},
  {676, 0.06},
  {677, 0.06},
  {678, 0.06},
  {679, 0.06},
  {680, 0.06},
  {681, 0.06},
  {682, 0.06},
  {683, 0.059},
  {684, 0.059},
  {685, 0.059},
  {686, 0.059},
  {687, 0.059},
  {688, 0.059},
  {689, 0.059},
  {690, 0.059},
  {691, 0.059},
  {692, 0.059},
  {693, 0.059},
  {694, 0.059},
  {695, 0.059},
  {696, 0.059},
  {697, 0.058},
  {698, 0.058},
  {699, 0.058},
  {700, 0.058},
  {701, 0.058},
  {702, 0.058},
  {703, 0.058},
  {704, 0.058},
  {705, 0.058},
  {706, 0.058},
  {707, 0.058},
  {708, 0.058},
  {709, 0.058},
  {710, 0.058},
  {711, 0.058},
  {712, 0.057},
  {713, 0.057},
  {714, 0.057},
  {715, 0.057},
  {716, 0.057},
  {717, 0.057},
  {718, 0.057},
  {719, 0.057},
  {720, 0.057},
  {721, 0.057},
  {722, 0.057},
  {723, 0.057},
  {724, 0.057},
  {725, 0.057},
  {726, 0.057},
  {727, 0.057},
  {728, 0.056},
  {729, 0.056},
  {730, 0.056},
  {731, 0.056},
  {732, 0.056},
  {733, 0.056},
  {734, 0.056},
  {735, 0.056},
  {736, 0.056},
  {737, 0.056},
  {738, 0.056},
  {739, 0.056},
  {740, 0.056},
  {741, 0.056},
  {742, 0.056},
  {743, 0.056},
  {744, 0.055},
  {745, 0.055},
  {746, 0.055},
  {747, 0.055},
  {748, 0.055},
  {749, 0.055},
  {750, 0.055},
  {751, 0.055},
  {752, 0.055},
  {753, 0.055},
  {754, 0.055},
  {755, 0.055},
  {756, 0.055},
  {757, 0.055},
  {758, 0.055},
  {759, 0.055},
  {760, 0.054},
  {761, 0.054},
  {762, 0.054},
  {763, 0.054},
  {764, 0.054},
  {765, 0.054},
  {766, 0.054},
  {767, 0.054},
  {768, 0.054},
  {769, 0.054},
  {770, 0.054},
  {771, 0.054},
  {772, 0.054},
  {773, 0.054},
  {774, 0.054},
  {775, 0.054},
  {776, 0.054},
  {777, 0.053},
  {778, 0.053},
  {779, 0.053},
  {780, 0.053},
  {781, 0.053},
  {782, 0.053},
  {783, 0.053},
  {784, 0.053},
  {785, 0.053},
  {786, 0.053},
  {787, 0.053},
  {788, 0.053},
  {789, 0.053},
  {790, 0.053},
  {791, 0.053},
  {792, 0.053},
  {793, 0.053},
  {794, 0.053},
  {795, 0.052},
  {796, 0.052},
  {797, 0.052},
  {798, 0.052},
  {799, 0.052},
  {800, 0.052},
  {801, 0.052},
  {802, 0.052},
  {803, 0.052},
  {804, 0.052},
  {805, 0.052},
  {806, 0.052},
  {807, 0.052},
  {808, 0.052},
  {809, 0.052},
  {810, 0.052},
  {811, 0.052},
  {812, 0.052},
  {813, 0.052},
  {814, 0.051},
  {815, 0.051},
  {816, 0.051},
  {817, 0.051},
  {818, 0.051},
  {819, 0.051},
  {820, 0.051},
  {821, 0.051},
  {822, 0.051},
  {823, 0.051},
  {824, 0.051},
  {825, 0.051},
  {826, 0.051},
  {827, 0.051},
  {828, 0.051},
  {829, 0.051},
  {830, 0.051},
  {831, 0.051},
  {832, 0.051},
  {833, 0.051},
  {834, 0.05},
  {835, 0.05},
  {836, 0.05},
  {837, 0.05},
  {838, 0.05},
  {839, 0.05},
  {840, 0.05},
  {841, 0.05},
  {842, 0.05},
  {843, 0.05},
  {844, 0.05},
  {845, 0.05},
  {846, 0.05},
  {847, 0.05},
  {848, 0.05},
  {849, 0.05},
  {850, 0.05},
  {851, 0.05},
  {852, 0.05},
  {853, 0.05},
  {854, 0.049},
  {855, 0.049},
  {856, 0.049},
  {857, 0.049},
  {858, 0.049},
  {859, 0.049},
  {860, 0.049},
  {861, 0.049},
  {862, 0.049},
  {863, 0.049},
  {864, 0.049},
  {865, 0.049},
  {866, 0.049},
  {867, 0.049},
  {868, 0.049},
  {869, 0.049},
  {870, 0.049},
  {871, 0.049},
  {872, 0.049},
  {873, 0.049},
  {874, 0.049},
  {875, 0.049},
  {876, 0.048},
  {877, 0.048},
  {878, 0.048},
  {879, 0.048},
  {880, 0.048},
  {881, 0.048},
  {882, 0.048},
  {883, 0.048},
  {884, 0.048},
  {885, 0.048},
  {886, 0.048},
  {887, 0.048},
  {888, 0.048},
  {889, 0.048},
  {890, 0.048},
  {891, 0.048},
  {892, 0.048},
  {893, 0.048},
  {894, 0.048},
  {895, 0.048},
  {896, 0.048},
  {897, 0.048},
  {898, 0.048},
  {899, 0.048},
  {900, 0.047},
  {901, 0.047},
  {902, 0.047},
  {903, 0.047},
  {904, 0.047},
  {905, 0.047},
  {906, 0.047},
  {907, 0.047},
  {908, 0.047},
  {909, 0.047},
  {910, 0.047},
  {911, 0.047},
  {912, 0.047},
  {913, 0.047},
  {914, 0.047},
  {915, 0.047},
  {916, 0.047},
  {917, 0.047},
  {918, 0.047},
  {919, 0.047},
  {920, 0.047},
  {921, 0.047},
  {922, 0.047},
  {923, 0.047},
  {924, 0.047},
  {925, 0.047},
  {926, 0.047},
  {927, 0.046},
  {928, 0.046},
  {929, 0.046},
  {930, 0.046},
  {931, 0.046},
  {932, 0.046},
  {933, 0.046},
  {934, 0.046},
  {935, 0.046},
  {936, 0.046},
  {937, 0.046},
  {938, 0.046},
  {939, 0.046},
  {940, 0.046},
  {941, 0.046},
  {942, 0.046},
  {943, 0.046},
  {944, 0.046},
  {945, 0.046},
  {946, 0.046},
  {947, 0.046},
  {948, 0.046},
  {949, 0.046},
  {950, 0.046},
  {951, 0.046},
  {952, 0.046},
  {953, 0.046},
  {954, 0.046},
  {955, 0.046},
  {956, 0.046},
  {957, 0.046},
  {958, 0.045},
  {959, 0.045},
  {960, 0.045},
  {961, 0.045},
  {962, 0.045},
  {963, 0.045},
  {964, 0.045},
  {965, 0.045},
  {966, 0.045},
  {967, 0.045},
  {968, 0.045},
  {969, 0.045},
  {970, 0.045},
  {971, 0.045},
  {972, 0.045},
  {973, 0.045},
  {974, 0.045},
  {975, 0.045},
  {976, 0.045},
  {977, 0.045},
  {978, 0.045},
  {979, 0.045},
  {980, 0.045},
  {981, 0.045},
  {982, 0.045},
  {983, 0.045},
  {984, 0.045},
  {985, 0.045},
  {986, 0.045},
  {987, 0.045},
  {988, 0.045},
  {989, 0.045},
  {990, 0.045},
  {991, 0.045},
  {992, 0.044},
  {993, 0.044},
  {994, 0.044},
  {995, 0.044},
  {996, 0.044},
  {997, 0.044},
  {998, 0.044},
  {999, 0.044},
  {1000, 0.044},

};

float getScintEfficiency(uint16_t energy) {

  // Get the corresponding index
  uint16_t index = (energy - scintData[0].energy) / (scintData[1].energy-scintData[0].energy);
  if (index >= 0 && index < sizeof(scintData)/sizeof(scintData[0])) { // Last check is to make sure the energy index is within the bounds of the table
    return scintData[index].efficiency;
  }
  // Return a default value (e.g., 0.0) if the energy is out of range
  return 0.0;
}


#endif  // SCINTILLATOR_H
